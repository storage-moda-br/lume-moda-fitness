<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sorteio dos Jogos</title>
<style>
  * { box-sizing: border-box; font-family: "Poppins", sans-serif; }
  body { margin:0; background:#f4f7fb; display:flex; flex-direction:column; align-items:center; min-height:100vh; padding:10px; }
  .container { background:white; width:100%; max-width:420px; padding:20px 15px; border-radius:20px; box-shadow:0 4px 12px rgba(0,0,0,0.1); overflow:hidden; }
  .header { display:flex; align-items:center; justify-content:center; margin-bottom:20px; position:relative; }
  .header img { height:60px; width:60px; object-fit:contain; position:absolute; left:0; transition:transform .3s ease, box-shadow .3s ease; cursor:pointer; }
  .header img:hover { transform:scale(1.2) rotate(360deg); box-shadow:0 0 10px rgba(0,147,255,0.7); }
  .header h1 { color:#0093ff; font-size:1.6rem; margin:0; text-align:center; width:100%; }
  .menu-icon { position:absolute; right:0; top:50%; transform:translateY(-50%); font-size:1.5rem; cursor:pointer; color:#333; transition:transform .3s; }
  .menu-icon:hover { transform:translateY(-50%) scale(1.1); }
  .menu-dropdown { display:none; position:absolute; right:0; top:60px; background:white; border-radius:8px; box-shadow:0 4px 8px rgba(0,0,0,0.2); z-index:1000; min-width:150px; }
  .menu-dropdown a { display:flex; align-items:center; padding:10px 15px; color:#333; text-decoration:none; font-size:.95rem; transition:background .2s; }
  .menu-dropdown a:hover { background:#e8f4ff; }
  .menu-dropdown a.trofeus::before { content:"ğŸ†"; margin-right:8px; }
  .menu-dropdown a.regras::before { content:"ğŸ“œ"; margin-right:8px; }
  .menu-dropdown a.sobre::before { content:"â„¹ï¸"; margin-right:8px; }

  .inputs { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:8px; margin-bottom:20px; }
  input { width:100%; padding:10px; border:1px solid #ddd; border-radius:10px; font-size:.95rem; }

  .jogador-ativo { background:#e8f4ff; border:2px solid #0093ff; }
  .jogador-fora { background:#f0f0f0; border:1px solid #ccc; color:#666; }

  .info { text-align:center; font-size:.9rem; color:#555; margin-bottom:15px; }

  button { display:block; width:100%; max-width:260px; margin:0 auto; padding:12px 20px; border:none; border-radius:30px; background:linear-gradient(90deg,#0093ff,#00c8ff); color:white; font-size:1rem; cursor:pointer; transition:.3s; }
  button:hover { transform:scale(1.03); }

  .result { margin-top:20px; }

  .dupla {
    background:#e8f4ff;
    margin-bottom:10px;
    border-radius:15px;
    padding:10px 15px;
    text-align:left;
    font-weight:500;
    font-size:.95rem;
    border:1px solid #0093ff;
    cursor:pointer;
    transition:background .3s, border-color .3s, box-shadow .3s;
    position:relative;
  }
  .dupla:hover { background:#d8efff; }

  .dupla-vencedora { background:#e6ffed !important; border-color:#28a745 !important; animation:brilhoVerde .6s ease-out; }
  .dupla-perdedora { background:#ffe6e6 !important; border-color:#dc3545 !important; animation:piscarVermelho .6s ease-out; opacity:.95; }

  .dupla-fora { background:#f0f0f0; border:1px solid #ccc; color:#666; margin-bottom:10px; border-radius:15px; padding:10px 15px; text-align:left; font-weight:500; font-size:.95rem; }

  .loading { display:flex; justify-content:center; align-items:center; height:80px; }
  .ball { width:18px; height:18px; margin:0 5px; border-radius:50%; background:#e4ff1a; animation:bounce .9s infinite alternate ease-in-out; }
  .ball:nth-child(2){animation-delay:.3s;} .ball:nth-child(3){animation-delay:.6s;}
  @keyframes bounce { from{transform:translateY(0);} to{transform:translateY(-18px);} }
  @keyframes brilhoVerde { from{box-shadow:0 0 0px #00ff80;} 50%{box-shadow:0 0 15px #00ff80;} to{box-shadow:0 0 0px #00ff80;} }
  @keyframes piscarVermelho { from{background:#ffe6e6;} 50%{background:#ffb3b3;} to{background:#ffe6e6;} }

  .trofeu { margin-left:6px; display:inline-block; animation:aparecerTrofeu .4s ease-out; }
  @keyframes aparecerTrofeu { from{opacity:0; transform:scale(.6);} to{opacity:1; transform:scale(1);} }

  .modal { display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; background-color:rgba(0,0,0,.5); }
  .modal-content { background-color:white; margin:10% auto; padding:20px; border-radius:15px; width:90%; max-width:400px; max-height:80vh; overflow-y:auto; }
  .modal-content h2 { text-align:center; color:#0093ff; margin-bottom:15px; }
  .ranking-item { display:flex; justify-content:space-between; align-items:center; padding:10px; margin-bottom:5px; background:#f8f9fa; border-radius:8px; border-left:4px solid #ffd700; }
  .ranking-name { font-weight:500; }
  .ranking-trophies { color:#1a3c34; font-size:1.2rem; }

  .close { color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer; margin-bottom:10px; }
  .close:hover { color:#000; }

  @media(max-width:360px){ .header h1{font-size:1.3rem;} input{font-size:.85rem;padding:8px;} button{font-size:.9rem;padding:10px 15px;} .dupla,.dupla-fora{font-size:.9rem;} .header img{height:64px;width:64px;} }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="https://i.imgur.com/rDZCHiH.png" alt="Logo" onclick="this.classList.add('pulse'); setTimeout(()=>this.classList.remove('pulse'),200);">
      <h1>Sorteio dos Jogos</h1>
      <span class="menu-icon" onclick="toggleMenu()">â˜°</span>
      <div class="menu-dropdown" id="menuDropdown">
        <a href="#" class="trofeus" onclick="abrirRanking()">TrofÃ©us</a>
        <a href="#" class="regras" onclick="abrirRegras()">Regras</a>
        <a href="#" class="sobre" onclick="abrirSobre()">Sobre</a>
      </div>
    </div>

    <div class="inputs">
      <input type="text" id="p1" value="Eduardo" class="jogador-ativo">
      <input type="text" id="p2" value="Julio" class="jogador-ativo">
      <input type="text" id="p3" value="Savio" class="jogador-ativo">
      <input type="text" id="p4" value="Wagner" class="jogador-ativo">
      <input type="text" id="p5" value="Ozimar" class="jogador-fora">
      <input type="text" id="p6" value="Artur" class="jogador-fora">
    </div>

    <p class="info">Apenas os 4 primeiros jogadores (em azul) sÃ£o sorteados para a primeira partida. Os outros estÃ£o de fora inicialmente.</p>
    <button id="sortear">ğŸ¾ Sortear Primeira Partida</button>
    <div class="result" id="resultado"></div>
  </div>

  <!-- Ranking Modal -->
  <div id="rankingModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="fecharRanking()">&times;</span>
      <h2>Ranking de TrofÃ©us</h2>
      <div id="rankingList"></div>
    </div>
  </div>

  <!-- Regras Modal -->
  <div id="regrasModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="fecharModal('regrasModal')">&times;</span>
      <h2>Regras do App</h2>
      <p>
        1. O sistema sorteia duplas entre 6 jogadores.<br>
        2. Apenas os 4 primeiros jogadores (em azul) participam da primeira partida, enquanto os 2 Ãºltimos (em cinza) ficam de fora.<br>
        3. ApÃ³s cada partida, a dupla vencedora Ã© selecionada, e a sequÃªncia de partidas Ã© gerada seguindo as regras combinatÃ³rias.<br>
        4. Para a segunda partida, os vencedores da primeira jogam com os jogadores que estavam de fora (sorteio entre os dois de fora).<br>
        5. A partir da terceira partida, jogadores que participaram de duas partidas seguidas sÃ£o substituÃ­dos pelos que estavam de fora.<br>
        6. O sistema evita repetir duplas de partidas anteriores atÃ© esgotar as combinaÃ§Ãµes.<br>
        7. Cada vitÃ³ria concede 1 trofÃ©u para cada jogador da dupla vencedora, visÃ­vel no ranking de trofÃ©us.
      </p>
    </div>
  </div>

  <!-- Sobre Modal -->
  <div id="sobreModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="fecharModal('sobreModal')">&times;</span>
      <h2>Sobre</h2>
      <p>Software desenvolvido por Eduardo Campelo para o play do Bisteca.</p>
    </div>
  </div>

<script type="module">
Â  // --- Firebase imports e inicializaÃ§Ã£o ---
Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
Â  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

Â  // ConfiguraÃ§Ã£o do Firebase
Â  const firebaseConfig = {
Â  Â  apiKey: "AIzaSyCbHS1KJ_-BApLiVsXjBrqdu7_T7oOoNYQ",
Â  Â  authDomain: "bistecaoapp.firebaseapp.com",
Â  Â  projectId: "bistecaoapp",
Â  Â  storageBucket: "bistecaoapp.firebasestorage.app",
Â  Â  messagingSenderId: "109247286783",
Â  Â  appId: "1:109247286783:web:cdf63945a8b0a88917ebca"
Â  };

Â  // Inicializa Firebase
Â  const app = initializeApp(firebaseConfig);
Â  const db = getFirestore(app);
Â  console.log("âœ… Firebase conectado com sucesso:", app);
/* ---------- estado helpers ---------- */
const botao = document.getElementById("sortear");
const resultado = document.getElementById("resultado");
let partidas = [];Â  Â  Â  Â  Â  Â  Â  Â  Â // { numero, dupla1:[a,b], dupla2:[c,d], deFora:[e,f], vencedor:null or '1'/'2' }
let usedPairs = new Set();Â  Â  Â  Â  Â // pares jÃ¡ jogados, formato "A|B" ordenado

function keyPair(a,b){ return [a,b].sort().join('|'); }
function embaralhar(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]] } return arr; }
function isDuplaRepetida(dupla){ return usedPairs.has(keyPair(dupla[0],dupla[1])); }

/* ---------- menu / modais (mantidos) ---------- */
function toggleMenu(){ const m=document.getElementById("menuDropdown"); m.style.display = m.style.display==='block' ? 'none' : 'block'; }
function fecharMenu(){ document.getElementById("menuDropdown").style.display='none'; }
function abrirRanking(){ fecharMenu(); atualizarRanking(); document.getElementById("rankingModal").style.display='block'; }
function fecharRanking(){ document.getElementById("rankingModal").style.display='none'; }
function abrirRegras(){ fecharMenu(); document.getElementById("regrasModal").style.display='block'; }
function abrirSobre(){ fecharMenu(); document.getElementById("sobreModal").style.display='block'; }
function fecharModal(id){ document.getElementById(id).style.display='none'; }

/* ---------- ranking (mantido) ---------- */
function atualizarRanking(){
Â  const nomes = [...Array(6)].map((_,i)=>document.getElementById('p'+(i+1)).value.trim());
Â  const trofeus = {}; nomes.forEach(n=>trofeus[n]=0);
Â  partidas.forEach(p=>{
Â  Â  if(p.vencedor){
Â  Â  Â  const vencedora = p.vencedor==='1' ? p.dupla1 : p.dupla2;
Â  Â  Â  vencedora.forEach(j => { if(trofeus[j]!==undefined) trofeus[j]++; });
Â  Â  }
Â  });
Â  const rankingHtml = Object.entries(trofeus).sort(([,a],[,b])=>b-a).map(([nome,count])=>`
Â  Â  <div class="ranking-item">
Â  Â  Â  <span class="ranking-name">${nome}</span>
Â  Â  Â  <span class="ranking-trophies">${count} ğŸ†</span>
Â  Â  </div>
Â  `).join('');
Â  document.getElementById('rankingList').innerHTML = rankingHtml;
}

/* ---------- criar primeira partida (igual ao anterior) ---------- */
function criarPrimeiraPartida(){
Â  const nomes = [...Array(6)].map((_,i)=>document.getElementById('p'+(i+1)).value.trim());
Â  if(nomes.some(n=>!n)){ resultado.innerHTML = `<p style="color:red;text-align:center;">Preencha todos os 6 nomes!</p>`; return; }
Â  const primeirosQuatro = nomes.slice(0,4);
Â  const embar = embaralhar([...primeirosQuatro]);
Â  const dupla1 = [embar[0], embar[1]];
Â  const dupla2 = [embar[2], embar[3]];
Â  const deFora = nomes.slice(4);
Â  partidas = [{ numero:1, dupla1, dupla2, deFora, vencedor:null }];
Â  usedPairs.clear(); // limpar histÃ³rico de pares porque iniciamos nova sequÃªncia
Â  mostrarPartidas();
}

/* ---------- helper: attach listeners to dinamically created dupla elements ---------- */
function attachClickListeners(){
Â  // para cada partida, substitui o nÃ³ (limpa listeners antigos) e adiciona novo listener se vencedor === null
Â  partidas.forEach(p => {
Â  Â  const id1 = `dupla1-${p.numero}`;
Â  Â  const id2 = `dupla2-${p.numero}`;
Â  Â  const el1 = document.getElementById(id1);
Â  Â  const el2 = document.getElementById(id2);
Â  Â  if(!el1 || !el2) return;
Â  Â  // substitui por clone para limpar listeners antigos
Â  Â  const newEl1 = el1.cloneNode(true);
Â  Â  el1.parentNode.replaceChild(newEl1, el1);
Â  Â  const newEl2 = el2.cloneNode(true);
Â  Â  el2.parentNode.replaceChild(newEl2, el2);
Â  Â  // somente se ainda nÃ£o houver vencedor, adiciona listener
Â  Â  if(p.vencedor === null){
Â  Â  Â  newEl1.style.cursor = 'pointer';
Â  Â  Â  newEl2.style.cursor = 'pointer';
Â  Â  Â  newEl1.addEventListener('click', ()=>selecionarVencedor(p.numero, 1));
Â  Â  Â  newEl2.addEventListener('click', ()=>selecionarVencedor(p.numero, 2));
Â  Â  } else {
Â  Â  Â  newEl1.style.cursor = 'default';
Â  Â  Â  newEl2.style.cursor = 'default';
Â  Â  }
Â  });
}

/* ---------- mostrar partidas (mantÃ©m visuais/trofÃ©u) ---------- */
function mostrarPartidas(){
Â  let html = '';
Â  partidas.forEach(p=>{
Â  Â  const class1 = p.vencedor === '1' ? 'dupla dupla-vencedora' : (p.vencedor === '2' ? 'dupla dupla-perdedora' : 'dupla');
Â  Â  const class2 = p.vencedor === '2' ? 'dupla dupla-vencedora' : (p.vencedor === '1' ? 'dupla dupla-perdedora' : 'dupla');
Â  Â  html += `<h3 style="text-align:center;">Partida ${p.numero}</h3>`;
Â  Â  html += `<div id="dupla1-${p.numero}" class="${class1}"><strong>Dupla 1:</strong> ${p.dupla1[0]} & ${p.dupla1[1]} ${p.vencedor==='1'?'<span class="trofeu">ğŸ†</span>':''}</div>`;
Â  Â  html += `<div id="dupla2-${p.numero}" class="${class2}"><strong>Dupla 2:</strong> ${p.dupla2[0]} & ${p.dupla2[1]} ${p.vencedor==='2'?'<span class="trofeu">ğŸ†</span>':''}</div>`;
Â  Â  html += `<div class="dupla-fora"><strong>De fora:</strong> ${p.deFora.join(' & ')}</div>`;
Â  });
Â  resultado.innerHTML = html;
Â  // reatribui listeners aos elementos recÃ©m-criados
Â  attachClickListeners();
Â  atualizarRanking();
}

/* ---------- seleÃ§Ã£o de vencedor (mantÃ©m classes) ---------- */
function selecionarVencedor(partidaNumero, dupla){
Â  const idx = partidas.findIndex(p=>p.numero===partidaNumero);
Â  if(idx === -1) return;
Â  const partida = partidas[idx];
Â  if(partida.vencedor !== null) return;
Â  partida.vencedor = dupla.toString();

Â  // registrar pares desta partida como jogados
Â  usedPairs.add(keyPair(partida.dupla1[0], partida.dupla1[1]));
Â  usedPairs.add(keyPair(partida.dupla2[0], partida.dupla2[1]));

Â  // atualizar UI (mantendo .dupla)
Â  const d1 = document.getElementById(`dupla1-${partidaNumero}`);
Â  const d2 = document.getElementById(`dupla2-${partidaNumero}`);
Â  if(dupla === 1){
Â  Â  if(d1) { d1.classList.add('dupla-vencedora'); d1.classList.remove('dupla-perdedora'); d1.innerHTML = `<strong>Dupla 1:</strong> ${partida.dupla1[0]} & ${partida.dupla1[1]} <span class="trofeu">ğŸ†</span>`; }
Â  Â  if(d2) { d2.classList.add('dupla-perdedora'); d2.classList.remove('dupla-vencedora'); d2.innerHTML = `<strong>Dupla 2:</strong> ${partida.dupla2[0]} & ${partida.dupla2[1]}`; }
Â  } else {
Â  Â  if(d2) { d2.classList.add('dupla-vencedora'); d2.classList.remove('dupla-perdedora'); d2.innerHTML = `<strong>Dupla 2:</strong> ${partida.dupla2[0]} & ${partida.dupla2[1]} <span class="trofeu">ğŸ†</span>`; }
Â  Â  if(d1) { d1.classList.add('dupla-perdedora'); d1.classList.remove('dupla-vencedora'); d1.innerHTML = `<strong>Dupla 1:</strong> ${partida.dupla1[0]} & ${partida.dupla1[1]}`; }
Â  }

Â  // Se for a primeira partida, gere automaticamente TODA a sequÃªncia (2..9) e mostre tudo
Â  if(partidaNumero === 1){
Â  Â  setTimeout(()=> {
Â  Â  Â  gerarSequenciaAposPrimeira(); // gera todas as partidas restantes de uma vez
Â  Â  Â  mostrarPartidas();
Â  Â  }, 350);
Â  } else {
Â  Â  // atualizaÃ§Ã£o visual e reatribuiÃ§Ã£o de listeners
Â  Â  setTimeout(()=> { mostrarPartidas(); }, 200);
Â  }
}

/* ---------- util: todas partitÃ§Ãµes 4 => 2 pares ---------- */
function todasParticoes4(lista4){
Â  const [a,b,c,d] = lista4;
Â  return [
Â  Â  [[a,b],[c,d]],
Â  Â  [[a,c],[b,d]],
Â  Â  [[a,d],[b,c]]
Â  ];
}

/* ---------- gerar prÃ³xima partida baseada em estado simulÃ¡vel (nÃ£o exige vencedor da Ãºltima) ---------- */
function gerarProximaPartidaSimulada(stateUltima, statePenultima){
Â  const nomes = [...Array(6)].map((_,i)=>document.getElementById('p'+(i+1)).value.trim());
Â  const jogadoresUltima = [...stateUltima.dupla1, ...stateUltima.dupla2];
Â  const jogadoresPenultima = statePenultima ? [...statePenultima.dupla1, ...statePenultima.dupla2] : [];
Â  const mustLeave = jogadoresUltima.filter(p => jogadoresPenultima.includes(p));
Â  const permanecer = jogadoresUltima.filter(p => !mustLeave.includes(p));
Â  const entra = stateUltima.deFora.slice();
Â  let candidatos = [...permanecer, ...entra];
Â  candidatos = candidatos.slice(0,4);
Â  if(candidatos.length < 4){
Â  Â  const faltam = nomes.filter(n => !candidatos.includes(n) && !jogadoresUltima.includes(n));
Â  Â  while(candidatos.length < 4 && faltam.length) candidatos.push(faltam.shift());
Â  }
Â  if(candidatos.length < 4) return null;
Â  const opcoes = todasParticoes4(candidatos);
Â  const ord = embaralhar(opcoes.slice());
Â  let escolhida = null;
Â  for(const opt of ord){
Â  Â  if(!isDuplaRepetida(opt[0]) && !isDuplaRepetida(opt[1])){
Â  Â  Â  escolhida = opt; break;
Â  Â  }
Â  }
Â  if(!escolhida){
Â  Â  let best = ord[0], bestR = 10;
Â  Â  ord.forEach(opt=>{
Â  Â  Â  const r = (isDuplaRepetida(opt[0])?1:0) + (isDuplaRepetida(opt[1])?1:0);
Â  Â  Â  if(r < bestR){ bestR = r; best = opt; }
Â  Â  });
Â  Â  escolhida = best;
Â  }
Â  if(!escolhida) return null;
Â  const dupla1 = escolhida[0], dupla2 = escolhida[1];
Â  const novaDeFora = nomes.filter(n => !candidatos.includes(n));
Â  usedPairs.add(keyPair(dupla1[0],dupla1[1]));
Â  usedPairs.add(keyPair(dupla2[0],dupla2[1]));
Â  return { numero: 0, dupla1, dupla2, deFora: novaDeFora, vencedor: null };
}

/* ---------- gerar toda sequÃªncia apÃ³s partida 1 (usa apenas vencedor da 1Âª) ---------- */
function gerarSequenciaAposPrimeira(){
Â  if(partidas.length === 0) return;
Â  const primeira = partidas[0];
Â  if(!primeira.vencedor) return;
Â  partidas = [partidas[0]];
Â  usedPairs.clear();
Â  usedPairs.add(keyPair(primeira.dupla1[0], primeira.dupla1[1]));
Â  usedPairs.add(keyPair(primeira.dupla2[0], primeira.dupla2[1]));
Â  let states = [];
Â  states.push({ dupla1: primeira.dupla1.slice(), dupla2: primeira.dupla2.slice(), deFora: primeira.deFora.slice() });
Â  const vencedores = primeira.vencedor === '1' ? primeira.dupla1.slice() : primeira.dupla2.slice();
Â  const perdedores = primeira.vencedor === '1' ? primeira.dupla2.slice() : primeira.dupla1.slice();
Â  const deFora = primeira.deFora.slice();
Â  const embFor = embaralhar(deFora.slice());
Â  const p2_dupla1 = [vencedores[0], embFor[0]];
Â  const p2_dupla2 = [vencedores[1], embFor[1]];
Â  const state2 = { dupla1: p2_dupla1, dupla2: p2_dupla2, deFora: perdedores.slice() };
Â  usedPairs.add(keyPair(p2_dupla1[0], p2_dupla1[1]));
Â  usedPairs.add(keyPair(p2_dupla2[0], p2_dupla2[1]));
Â  states.push(state2);
Â  for(let idx = 3; idx <= 9; idx++){
Â  Â  const stateUlt = states[states.length - 1];
Â  Â  const statePen = states.length >= 2 ? states[states.length - 2] : null;
Â  Â  const nova = gerarProximaPartidaSimulada(stateUlt, statePen);
Â  Â  if(!nova) break;
Â  Â  nova.numero = idx;
Â  Â  states.push({ dupla1: nova.dupla1.slice(), dupla2: nova.dupla2.slice(), deFora: nova.deFora.slice() });
Â  }
Â  for(let i = 1; i < states.length; i++){
Â  Â  const st = states[i];
Â  Â  partidas.push({ numero: partidas.length+1, dupla1: st.dupla1.slice(), dupla2: st.dupla2.slice(), deFora: st.deFora.slice(), vencedor: null });
Â  }
}

/* ---------- evento do botÃ£o sortear (apenas gera 1Âª partida) ---------- */
botao.addEventListener('click', ()=>{
Â  resultado.innerHTML = `<div class="loading"><div class="ball"></div><div class="ball"></div><div class="ball"></div></div><p style="text-align:center;">Sorteando as duplas...</p>`;
Â  setTimeout(()=>{
Â  Â  partidas = [];
Â  Â  usedPairs.clear();
Â  Â  criarPrimeiraPartida();
Â  }, 700);
});

/* ---------- fechar modais/menu ao clicar fora (mantido) ---------- */
window.onclick = function(evt){
Â  const modalRanking = document.getElementById("rankingModal");
Â  const modalRegras = document.getElementById("regrasModal");
Â  const modalSobre = document.getElementById("sobreModal");
Â  const menu = document.getElementById("menuDropdown");
Â  if(evt.target == modalRanking) fecharRanking();
Â  else if(evt.target == modalRegras) fecharModal('regrasModal');
Â  else if(evt.target == modalSobre) fecharModal('sobreModal');
Â  else if(!evt.target.closest('.menu-icon') && !evt.target.closest('.menu-dropdown')) fecharMenu();
};
/* ---------- duplo clique para desfazer vitÃ³ria (mantido) ---------- */
document.addEventListener('dblclick', function (e) {
Â  // identifica se o clique duplo foi em uma dupla vencedora
Â  const el = e.target.closest('.dupla-vencedora');
Â  if (!el) return;

Â  const id = el.id;
Â  const match = id.match(/dupla(1|2)-(\d+)/);
Â  if (!match) return;

Â  const numDupla = match[1];Â  Â // '1' ou '2'
Â  const numPartida = parseInt(match[2]); // nÃºmero da partida
Â  const partida = partidas.find(p => p.numero === numPartida);
Â  if (!partida || partida.vencedor !== numDupla) return;

Â  // desfaz o vencedor
Â  partida.vencedor = null;

Â  // remove estilos de vencedor/perdedor
Â  const d1 = document.getElementById(`dupla1-${numPartida}`);
Â  const d2 = document.getElementById(`dupla2-${numPartida}`);
Â  if (d1) {
Â  Â  d1.classList.remove('dupla-vencedora', 'dupla-perdedora');
Â  Â  d1.innerHTML = `<strong>Dupla 1:</strong> ${partida.dupla1[0]} & ${partida.dupla1[1]}`;
Â  }
Â  if (d2) {
Â  Â  d2.classList.remove('dupla-vencedora', 'dupla-perdedora');
Â  Â  d2.innerHTML = `<strong>Dupla 2:</strong> ${partida.dupla2[0]} & ${partida.dupla2[1]}`;
Â  }

Â  // efeito visual rÃ¡pido de reversÃ£o
Â  el.style.transition = 'background-color 0.3s';
Â  el.style.backgroundColor = '#ffe6e6';
Â  setTimeout(() => el.style.backgroundColor = '', 400);

Â  // atualiza o ranking e reacopla listeners
Â  mostrarPartidas();
});


/* ---------- ANEXAR LISTENERS APÃ“S O DOM CARREGAR (CorreÃ§Ã£o do erro ReferenceError) ---------- */
document.addEventListener('DOMContentLoaded', () => {
Â  // Listener para o Ã­cone do menu
Â  document.querySelector('.menu-icon').addEventListener('click', toggleMenu);

Â  // Listeners para os itens do menu
Â  document.querySelector('.menu-dropdown a.trofeus').addEventListener('click', (e) => { e.preventDefault(); abrirRanking(); });
Â  document.querySelector('.menu-dropdown a.regras').addEventListener('click', (e) => { e.preventDefault(); abrirRegras(); });
Â  document.querySelector('.menu-dropdown a.sobre').addEventListener('click', (e) => { e.preventDefault(); abrirSobre(); });
Â  
Â  // Listeners para fechar modais (botÃµes X)
Â  document.querySelector('#rankingModal .close').addEventListener('click', fecharRanking);
Â  document.querySelector('#regrasModal .close').addEventListener('click', () => fecharModal('regrasModal'));
Â  document.querySelector('#sobreModal .close').addEventListener('click', () => fecharModal('sobreModal'));
Â  
Â  // Efeito de clique na logo (adaptado do onclick)
Â  const logo = document.querySelector('.header img');
Â  if(logo) {
Â  Â  logo.addEventListener('click', () => {
Â  Â  Â  logo.classList.add('pulse');
Â  Â  Â  setTimeout(() => logo.classList.remove('pulse'), 200);
Â  Â  });
Â  }
});

// atualiza o ranking e reacopla listeners
mostrarPartidas();
</script>
</body>
</html>
</body>
</html>